P8105 HW2
================
Jennifer Lee (UNI: jl2361)

We will first load the tidyverse.

``` r
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
    ## ✔ ggplot2 3.3.6      ✔ purrr   0.3.4 
    ## ✔ tibble  3.1.8      ✔ dplyr   1.0.10
    ## ✔ tidyr   1.2.0      ✔ stringr 1.4.1 
    ## ✔ readr   2.1.2      ✔ forcats 0.5.2 
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()

# Problem 1

``` r
nyctransit = read_csv('data/NYC_Transit.csv', col_types = cols(Route8 = "c", Route9 = "c", Route10 = "c", Route11 = "c", ADA = "c")) %>%
  janitor::clean_names() %>%
  select(line, station_name, station_latitude, station_longitude, starts_with('route'), entrance_type, entry, exit_only, vending, ada) %>%
  mutate(entry = recode(entry, 'YES' = TRUE, 'NO' = FALSE),
         across(where(is.character), tolower))

head(nyctransit)
```

    ## # A tibble: 6 × 20
    ##   line  stati…¹ stati…² stati…³ route1 route2 route3 route4 route5 route6 route7
    ##   <chr> <chr>     <dbl>   <dbl> <chr>  <chr>  <chr>  <chr>  <chr>  <chr>  <chr> 
    ## 1 4 av… 25th st    40.7   -74.0 r      <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  
    ## 2 4 av… 25th st    40.7   -74.0 r      <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  
    ## 3 4 av… 36th st    40.7   -74.0 n      r      <NA>   <NA>   <NA>   <NA>   <NA>  
    ## 4 4 av… 36th st    40.7   -74.0 n      r      <NA>   <NA>   <NA>   <NA>   <NA>  
    ## 5 4 av… 36th st    40.7   -74.0 n      r      <NA>   <NA>   <NA>   <NA>   <NA>  
    ## 6 4 av… 45th st    40.6   -74.0 r      <NA>   <NA>   <NA>   <NA>   <NA>   <NA>  
    ## # … with 9 more variables: route8 <chr>, route9 <chr>, route10 <chr>,
    ## #   route11 <chr>, entrance_type <chr>, entry <lgl>, exit_only <chr>,
    ## #   vending <chr>, ada <chr>, and abbreviated variable names ¹​station_name,
    ## #   ²​station_latitude, ³​station_longitude

``` r
nrow(distinct(nyctransit, line, station_name))
```

    ## [1] 465

``` r
nrow(distinct(filter(nyctransit, ada == 'true'), line, station_name, .keep_all = TRUE))
```

    ## [1] 84

``` r
round(nrow(filter(nyctransit, vending == 'no', entry == TRUE)) / nrow(nyctransit) * 100, digits = 2)
```

    ## [1] 3.69

``` r
nyctransitreformat = 
  pivot_longer(
    nyctransit, 
    route1:route11,
    names_to = "route_number",
    values_to = "route_name",
    names_prefix = 'route') 
```

``` r
nrow(distinct(filter(nyctransitreformat, route_name == 'a'), line, station_name, .keep_all = TRUE))
```

    ## [1] 60

``` r
nrow(distinct(filter(nyctransitreformat, route_name == 'a', ada == 'true'), line, station_name, .keep_all = TRUE))
```

    ## [1] 17

# Problem 2

``` r
mr_trashwheel = readxl::read_excel('data/Trash_Wheel.xlsx', 
                                   sheet = 1, 
                                   range = 'A2:N534') %>%
  janitor::clean_names() %>%
  drop_na(dumpster) %>%
  mutate(
    sports_balls = as.integer(round(sports_balls, digit = 0)),
    id = paste('mr', row_number(), sep = '_')) %>%
    relocate(id)

professor_trashwheel = readxl::read_excel('data/Trash_Wheel.xlsx', 
                                   sheet = 2, 
                                   range = 'A2:N116') %>%
  janitor::clean_names() %>%
  drop_na(dumpster) %>%
  mutate(
    sports_balls = as.integer(round(sports_balls, digit = 0)),
    id = paste('prof', row_number(), sep = '_')) %>%
    relocate(id)

total_trashwheel = bind_rows(mr_trashwheel, professor_trashwheel)

head(total_trashwheel)
```

    ## # A tibble: 6 × 15
    ##   id    dumpster month  year date                weigh…¹ volum…² plast…³ polys…⁴
    ##   <chr>    <dbl> <chr> <dbl> <dttm>                <dbl>   <dbl>   <dbl>   <dbl>
    ## 1 mr_1         1 May    2014 2014-05-16 00:00:00    4.31      18    1450    1820
    ## 2 mr_2         2 May    2014 2014-05-16 00:00:00    2.74      13    1120    1030
    ## 3 mr_3         3 May    2014 2014-05-16 00:00:00    3.45      15    2450    3100
    ## 4 mr_4         4 May    2014 2014-05-17 00:00:00    3.1       15    2380    2730
    ## 5 mr_5         5 May    2014 2014-05-17 00:00:00    4.06      18     980     870
    ## 6 mr_6         6 May    2014 2014-05-20 00:00:00    2.71      13    1430    2140
    ## # … with 6 more variables: cigarette_butts <dbl>, glass_bottles <dbl>,
    ## #   grocery_bags <dbl>, chip_bags <dbl>, sports_balls <int>,
    ## #   homes_powered <dbl>, and abbreviated variable names ¹​weight_tons,
    ## #   ²​volume_cubic_yards, ³​plastic_bottles, ⁴​polystyrene

``` r
nrow(total_trashwheel)
```

    ## [1] 524

``` r
summary(mr_trashwheel)
```

    ##       id               dumpster      month                year     
    ##  Length:453         Min.   :  1   Length:453         Min.   :2014  
    ##  Class :character   1st Qu.:114   Class :character   1st Qu.:2015  
    ##  Mode  :character   Median :227   Mode  :character   Median :2018  
    ##                     Mean   :227                      Mean   :2017  
    ##                     3rd Qu.:340                      3rd Qu.:2019  
    ##                     Max.   :453                      Max.   :2021  
    ##       date                         weight_tons   volume_cubic_yards
    ##  Min.   :1900-01-20 00:00:00.00   Min.   :0.78   Min.   : 7.00     
    ##  1st Qu.:2015-12-26 00:00:00.00   1st Qu.:2.72   1st Qu.:15.00     
    ##  Median :2018-02-05 00:00:00.00   Median :3.19   Median :15.00     
    ##  Mean   :2017-07-03 05:36:57.22   Mean   :3.20   Mean   :15.41     
    ##  3rd Qu.:2019-05-28 00:00:00.00   3rd Qu.:3.68   3rd Qu.:15.00     
    ##  Max.   :2021-01-04 00:00:00.00   Max.   :5.62   Max.   :20.00     
    ##  plastic_bottles  polystyrene   cigarette_butts  glass_bottles   
    ##  Min.   : 210    Min.   : 210   Min.   :   980   Min.   :  0.00  
    ##  1st Qu.: 980    1st Qu.: 950   1st Qu.:  5000   1st Qu.:  9.00  
    ##  Median :1850    Median :1650   Median : 11000   Median : 18.00  
    ##  Mean   :1899    Mean   :1921   Mean   : 24522   Mean   : 22.45  
    ##  3rd Qu.:2640    3rd Qu.:2730   3rd Qu.: 32000   3rd Qu.: 32.00  
    ##  Max.   :5960    Max.   :6540   Max.   :310000   Max.   :110.00  
    ##   grocery_bags    chip_bags     sports_balls   homes_powered  
    ##  Min.   :  50   Min.   : 180   Min.   : 0.00   Min.   : 0.00  
    ##  1st Qu.: 425   1st Qu.: 800   1st Qu.: 5.00   1st Qu.:38.83  
    ##  Median : 820   Median :1327   Median : 9.00   Median :51.17  
    ##  Mean   :1104   Mean   :1558   Mean   :11.75   Mean   :45.32  
    ##  3rd Qu.:1620   3rd Qu.:2150   3rd Qu.:16.00   3rd Qu.:58.67  
    ##  Max.   :3750   Max.   :5085   Max.   :56.00   Max.   :93.67

``` r
summary(professor_trashwheel)
```

    ##       id               dumpster       month                year     
    ##  Length:71          Min.   : 1.0   Length:71          Min.   :2017  
    ##  Class :character   1st Qu.:18.5   Class :character   1st Qu.:2018  
    ##  Mode  :character   Median :36.0   Mode  :character   Median :2018  
    ##                     Mean   :36.0                      Mean   :2018  
    ##                     3rd Qu.:53.5                      3rd Qu.:2019  
    ##                     Max.   :71.0                      Max.   :2021  
    ##       date                         weight_tons    volume_cubic_yards
    ##  Min.   :2017-01-02 00:00:00.00   Min.   :0.610   Min.   : 6.00     
    ##  1st Qu.:2017-12-16 12:00:00.00   1st Qu.:1.575   1st Qu.:15.00     
    ##  Median :2018-09-01 00:00:00.00   Median :1.810   Median :15.00     
    ##  Mean   :2018-10-26 15:32:57.46   Mean   :1.908   Mean   :14.59     
    ##  3rd Qu.:2019-08-13 00:00:00.00   3rd Qu.:2.355   3rd Qu.:15.00     
    ##  Max.   :2021-01-04 00:00:00.00   Max.   :3.720   Max.   :18.00     
    ##  plastic_bottles  polystyrene    cigarette_butts glass_bottles  
    ##  Min.   : 657    Min.   : 1030   Min.   : 6000   Min.   : 0.00  
    ##  1st Qu.:3900    1st Qu.: 3675   1st Qu.: 8750   1st Qu.: 4.00  
    ##  Median :6000    Median : 5500   Median :12400   Median :11.00  
    ##  Mean   :5715    Mean   : 5900   Mean   :14167   Mean   :11.86  
    ##  3rd Qu.:7980    3rd Qu.: 8330   3rd Qu.:18000   3rd Qu.:18.00  
    ##  Max.   :9830    Max.   :11528   Max.   :33320   Max.   :32.00  
    ##   grocery_bags     chip_bags      sports_balls    homes_powered  
    ##  Min.   :  540   Min.   : 2900   Min.   :0.0000   Min.   :10.17  
    ##  1st Qu.:  945   1st Qu.: 5346   1st Qu.:0.0000   1st Qu.:26.25  
    ##  Median : 1300   Median : 7800   Median :0.0000   Median :30.17  
    ##  Mean   : 3246   Mean   : 9128   Mean   :0.1972   Mean   :31.81  
    ##  3rd Qu.: 3950   3rd Qu.:12990   3rd Qu.:0.0000   3rd Qu.:39.25  
    ##  Max.   :13450   Max.   :20100   Max.   :7.0000   Max.   :62.00

``` r
summary(total_trashwheel)
```

    ##       id               dumpster        month                year     
    ##  Length:524         Min.   :  1.0   Length:524         Min.   :2014  
    ##  Class :character   1st Qu.: 66.0   Class :character   1st Qu.:2016  
    ##  Mode  :character   Median :191.5   Mode  :character   Median :2018  
    ##                     Mean   :201.1                      Mean   :2017  
    ##                     3rd Qu.:322.2                      3rd Qu.:2019  
    ##                     Max.   :453.0                      Max.   :2021  
    ##       date                         weight_tons    volume_cubic_yards
    ##  Min.   :1900-01-20 00:00:00.00   Min.   :0.610   Min.   : 6.0      
    ##  1st Qu.:2016-04-30 00:00:00.00   1st Qu.:2.475   1st Qu.:15.0      
    ##  Median :2018-04-16 00:00:00.00   Median :3.090   Median :15.0      
    ##  Mean   :2017-09-06 07:52:40.30   Mean   :3.025   Mean   :15.3      
    ##  3rd Qu.:2019-06-12 00:00:00.00   3rd Qu.:3.572   3rd Qu.:15.0      
    ##  Max.   :2021-01-04 00:00:00.00   Max.   :5.620   Max.   :20.0      
    ##  plastic_bottles  polystyrene    cigarette_butts  glass_bottles   
    ##  Min.   : 210    Min.   :  210   Min.   :   980   Min.   :  0.00  
    ##  1st Qu.:1075    1st Qu.:  990   1st Qu.:  5500   1st Qu.:  8.00  
    ##  Median :1980    Median : 2000   Median : 11000   Median : 18.00  
    ##  Mean   :2416    Mean   : 2460   Mean   : 23119   Mean   : 21.02  
    ##  3rd Qu.:2875    3rd Qu.: 3152   3rd Qu.: 28000   3rd Qu.: 29.50  
    ##  Max.   :9830    Max.   :11528   Max.   :310000   Max.   :110.00  
    ##   grocery_bags     chip_bags        sports_balls   homes_powered  
    ##  Min.   :   50   Min.   :  180.0   Min.   : 0.00   Min.   : 0.00  
    ##  1st Qu.:  480   1st Qu.:  878.5   1st Qu.: 3.00   1st Qu.:33.62  
    ##  Median :  890   Median : 1565.0   Median : 8.00   Median :48.83  
    ##  Mean   : 1394   Mean   : 2584.0   Mean   :10.18   Mean   :43.49  
    ##  3rd Qu.: 1752   3rd Qu.: 2760.0   3rd Qu.:14.00   3rd Qu.:57.17  
    ##  Max.   :13450   Max.   :20100.0   Max.   :56.00   Max.   :93.67

``` r
sum(pull(professor_trashwheel, weight_tons))
```

    ## [1] 135.5

``` r
mr_trashwheel2020 = filter(mr_trashwheel, year == 2020) 
sum(pull(mr_trashwheel2020, sports_balls))
```

    ## [1] 856

# Problem 3

``` r
polsmonth = read_csv('data/fivethirtyeight_polsmonth.csv') %>%
  janitor::clean_names() %>%
  separate(col = mon, into = c('year', 'month', 'day'), sep = "-") %>%
  mutate(
    year = as.integer(year), 
    month = as.integer(month),
    day = as.integer(day),
    month = recode(month, '1' = "jan", '2' = "feb", '3' = "mar", '4' = "apr", '5' = "may", '6' = "jun", '7' = "jul", '8' = "aug", '9' = "sep", '10' = "oct", '11' = "nov", '12' = "dec"),
    president = recode(prez_gop, '1' = "gop", '0' = "dem")) %>%
  select(-prez_dem, -prez_gop, -day) %>%
  arrange(year, month)
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

    ## Warning: Unreplaced values treated as NA as `.x` is not compatible.
    ## Please specify replacements exhaustively or supply `.default`.

``` r
head(polsmonth)
```

    ## # A tibble: 6 × 9
    ##    year month gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president
    ##   <int> <chr>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>    
    ## 1  1947 apr        23      51     253      23      45     198 dem      
    ## 2  1947 aug        23      51     253      23      45     198 dem      
    ## 3  1947 dec        24      51     253      23      45     198 dem      
    ## 4  1947 feb        23      51     253      23      45     198 dem      
    ## 5  1947 jan        23      51     253      23      45     198 dem      
    ## 6  1947 jul        23      51     253      23      45     198 dem

``` r
snp = read_csv('data/fivethirtyeight_snp.csv') %>%
  janitor::clean_names() %>%
  mutate(
    date = as.Date(date, format = "%m/%d/%y")) %>%
  separate(col = date, into = c('year', 'month', 'day'), sep = "-") %>%
  mutate(
    year = as.integer(year), 
    month = as.integer(month),
    day = as.integer(day),
    month = recode(month, '1' = "jan", '2' = "feb", '3' = "mar", '4' = "apr", '5' = "may", '6' = "jun", '7' = "jul", '8' = "aug", '9' = "sep", '10' = "oct", '11' = "nov", '12' = "dec")) %>%
  select(-day) %>%
    arrange(year, month)
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
head(snp)
```

    ## # A tibble: 6 × 3
    ##    year month close
    ##   <int> <chr> <dbl>
    ## 1  1969 apr   104. 
    ## 2  1969 aug    95.5
    ## 3  1969 dec    92.1
    ## 4  1969 feb    98.1
    ## 5  1969 jan   103. 
    ## 6  1969 jul    91.8

``` r
summary(snp)
```

    ##       year         month               close        
    ##  Min.   :1969   Length:787         Min.   :  17.05  
    ##  1st Qu.:1985   Class :character   1st Qu.:  83.73  
    ##  Median :2001   Mode  :character   Median : 138.53  
    ##  Mean   :2011                      Mean   : 474.89  
    ##  3rd Qu.:2052                      3rd Qu.: 941.79  
    ##  Max.   :2068                      Max.   :2107.39

``` r
unemploy = read_csv('data/fivethirtyeight_unemployment.csv') %>%
  janitor::clean_names() %>%
  mutate(
    year = as.integer(year)) %>%
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "unemployment") %>%
    arrange(year, month)
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
head(unemploy)
```

    ## # A tibble: 6 × 3
    ##    year month unemployment
    ##   <int> <chr>        <dbl>
    ## 1  1948 apr            3.9
    ## 2  1948 aug            3.9
    ## 3  1948 dec            4  
    ## 4  1948 feb            3.8
    ## 5  1948 jan            3.4
    ## 6  1948 jul            3.6

``` r
summary(unemploy)
```

    ##       year         month            unemployment  
    ##  Min.   :1948   Length:816         Min.   : 2.50  
    ##  1st Qu.:1965   Class :character   1st Qu.: 4.70  
    ##  Median :1982   Mode  :character   Median : 5.60  
    ##  Mean   :1982                      Mean   : 5.83  
    ##  3rd Qu.:1998                      3rd Qu.: 6.90  
    ##  Max.   :2015                      Max.   :10.80  
    ##                                    NA's   :6

``` r
pol_snp = left_join(polsmonth, snp, by = c("year", "month"))
unemploy_pol_snp = left_join(pol_snp, unemploy, by = c("year", "month"))

head(unemploy_pol_snp)
```

    ## # A tibble: 6 × 11
    ##    year month gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president close
    ##   <int> <chr>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>     <dbl>
    ## 1  1947 apr        23      51     253      23      45     198 dem          NA
    ## 2  1947 aug        23      51     253      23      45     198 dem          NA
    ## 3  1947 dec        24      51     253      23      45     198 dem          NA
    ## 4  1947 feb        23      51     253      23      45     198 dem          NA
    ## 5  1947 jan        23      51     253      23      45     198 dem          NA
    ## 6  1947 jul        23      51     253      23      45     198 dem          NA
    ## # … with 1 more variable: unemployment <dbl>

``` r
summary(unemploy_pol_snp)
```

    ##       year         month              gov_gop         sen_gop    
    ##  Min.   :1947   Length:822         Min.   :12.00   Min.   :32.0  
    ##  1st Qu.:1964   Class :character   1st Qu.:18.00   1st Qu.:42.0  
    ##  Median :1981   Mode  :character   Median :22.00   Median :46.0  
    ##  Mean   :1981                      Mean   :22.48   Mean   :46.1  
    ##  3rd Qu.:1998                      3rd Qu.:28.00   3rd Qu.:51.0  
    ##  Max.   :2015                      Max.   :34.00   Max.   :56.0  
    ##                                                                  
    ##     rep_gop         gov_dem        sen_dem         rep_dem   
    ##  Min.   :141.0   Min.   :17.0   Min.   :44.00   Min.   :188  
    ##  1st Qu.:176.0   1st Qu.:22.0   1st Qu.:48.00   1st Qu.:211  
    ##  Median :195.0   Median :28.0   Median :53.00   Median :250  
    ##  Mean   :194.9   Mean   :27.2   Mean   :54.41   Mean   :245  
    ##  3rd Qu.:222.0   3rd Qu.:32.0   3rd Qu.:58.00   3rd Qu.:268  
    ##  Max.   :253.0   Max.   :41.0   Max.   :71.00   Max.   :301  
    ##                                                              
    ##   president             close          unemployment  
    ##  Length:822         Min.   :  63.54   Min.   : 2.50  
    ##  Class :character   1st Qu.: 114.69   1st Qu.: 4.70  
    ##  Mode  :character   Median : 413.37   Median : 5.60  
    ##                     Mean   : 643.34   Mean   : 5.83  
    ##                     3rd Qu.:1146.78   3rd Qu.: 6.90  
    ##                     Max.   :2107.39   Max.   :10.80  
    ##                     NA's   :264       NA's   :12
